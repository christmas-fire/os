# Лабораторная работа: Атомарные операции и алгоритм Петерсона

## Описание

Данная лабораторная работа демонстрирует использование атомарных операций в C11 для решения задач синхронизации потоков. Программа расширяет классический алгоритм Петерсона атомарными операциями.

## Файлы в проекте

1. **peterson_classic.c** - Классическая реализация алгоритма Петерсона
2. **peterson_atomic.c** - Версия с атомарными операциями
3. **lockfree_examples.c** - Демонстрация lock-free структур данных
4. **Makefile** - Файл сборки проекта

## Сравнение версий

### Классическая версия (peterson_classic.c)
- Использует обычные переменные
- Алгоритм Петерсона для синхронизации
- Простой счетчик операций

### Атомарная версия (peterson_atomic.c)  
- Использует атомарные переменные для алгоритма Петерсона
- Демонстрирует разные типы атомарных операций
- Сравнивает результаты обычных и атомарных операций

## Атомарные операции, использованные в программе

### 1. Базовые атомарные операции

#### atomic_store()
```c
atomic_store(&flagReady[threadId], 1);
```
Атомарная запись значения.

#### atomic_load()
```c
int value = atomic_load(&atomic_sh);
```
Атомарное чтение значения.

### 2. Арифметические атомарные операции

#### atomic_fetch_add()
```c
atomic_fetch_add(&atomic_sh, 1);
```
Атомарное сложение. Возвращает предыдущее значение.

## Компиляция и запуск

### Компиляция:
```bash
gcc -Wall -Wextra -std=c11 -pthread -o peterson_classic peterson_classic.c
gcc -Wall -Wextra -std=c11 -pthread -o peterson_atomic peterson_atomic.c
gcc -Wall -Wextra -std=c11 -pthread -o lockfree_examples lockfree_examples.c
```

### Запуск:
```bash
./peterson_classic
./peterson_atomic
./lockfree_examples
```

## Ожидаемые результаты

### Peterson Classic:
```
Алгоритм Петерсона (классический)
Результат: 300
Общее количество операций: 200
```

### Peterson Atomic:
```
Алгоритм Петерсона с атомарными операциями
Результат (обычная переменная): 300
Результат (атомарная переменная): 300
Общее количество операций: 200
```

## Преимущества атомарных операций

1. **Гарантированная атомарность** - Операции выполняются неделимо
2. **Видимость между потоками** - Изменения сразу видны другим потокам
3. **Memory ordering** - Контроль порядка выполнения операций
4. **Lock-free программирование** - Избежание блокировок

## Технические детали

- Стандарт: C11 с поддержкой stdatomic.h
- Потоки: POSIX threads (pthread)
- Компилятор: GCC с флагами -std=c11 -pthread
